import{p as me,aB as ve,aC as we,q as fe,E as pe,aD as ge,aE as Ce,c as M,K as Ve,aF as ye,aG as Q,L as t,M as L,aH as Pe,aI as Fe,G as g,s as Se,d as Ae,o as Ie,w as H,b as Re,aJ as $e,aK as De,O as K,ai as te,aL as Me,aM as Ue,aN as Be,aO as Te,Q as J,aP as Ne,a as qe,a8 as Ee,a1 as ze,al as Ge,aQ as He,a3 as Oe,S as le,X as _e,a4 as u,_ as Le,Y as C,an as O,a6 as D,ao as oe,az as X,V as ne,U as je,ak as Ke,Z as Qe,a5 as d,aR as Je,ay as re,av as Xe,ax as Ye,aS as ue,aT as se,ar as Ze}from"./index-O_OIJZ_k.js";import{c as We,a as Y,b as ea,d as aa,u as ta,e as _,V as la}from"./index.esm-BYzkOkrp.js";import{a as oa,V as ie,b as de}from"./route-block-XNcMZbMm.js";import{V as na}from"./VDivider-CsSZj-Rn.js";import{m as ra,a as ce,V as ua,b as sa}from"./VDataTable-C0xNvz0u.js";import{V as ia}from"./VToolbar-Ni3OiqVV.js";import{V as da}from"./VContainer-BCZ9p7b9.js";import"./VPagination-C7GU0Q3Z.js";import"./VList-B5bKv3Qo.js";import"./VMenu-CrbXM0m4.js";const ca=me({...ve(),...we(ra(),["inline"])},"VCheckbox"),ma=fe()({name:"VCheckbox",inheritAttrs:!1,props:ca(),emits:{"update:modelValue":e=>!0,"update:focused":e=>!0},setup(e,n){let{attrs:b,slots:y}=n;const i=pe(e,"modelValue"),{isFocused:c,focus:k,blur:U}=ge(e),v=Ce(),B=M(()=>e.id||`checkbox-${v}`);return Ve(()=>{const[T,N]=ye(b),x=Q.filterProps(e),P=ce.filterProps(e);return t(Q,L({class:["v-checkbox",e.class]},T,x,{modelValue:i.value,"onUpdate:modelValue":F=>i.value=F,id:B.value,focused:c.value,style:e.style}),{...y,default:F=>{let{id:S,messagesId:E,isDisabled:A,isReadonly:z,isValid:I}=F;return t(ce,L(P,{id:S.value,"aria-describedby":E.value,disabled:A.value,readonly:z.value},N,{error:I.value===!1,modelValue:i.value,"onUpdate:modelValue":R=>i.value=R,onFocus:k,onBlur:U}),y)}})}),{}}}),va=me({autoGrow:Boolean,autofocus:Boolean,counter:[Boolean,Number,String],counterValue:Function,prefix:String,placeholder:String,persistentPlaceholder:Boolean,persistentCounter:Boolean,noResize:Boolean,rows:{type:[Number,String],default:5,validator:e=>!isNaN(parseFloat(e))},maxRows:{type:[Number,String],validator:e=>!isNaN(parseFloat(e))},suffix:String,modelModifiers:Object,...ve(),...Pe()},"VTextarea"),fa=fe()({name:"VTextarea",directives:{Intersect:Fe},inheritAttrs:!1,props:va(),emits:{"click:control":e=>!0,"mousedown:control":e=>!0,"update:focused":e=>!0,"update:modelValue":e=>!0},setup(e,n){let{attrs:b,emit:y,slots:i}=n;const c=pe(e,"modelValue"),{isFocused:k,focus:U,blur:v}=ge(e),B=M(()=>typeof e.counterValue=="function"?e.counterValue(c.value):(c.value||"").toString().length),T=M(()=>{if(b.maxlength)return b.maxlength;if(!(!e.counter||typeof e.counter!="number"&&typeof e.counter!="string"))return e.counter});function N(r,p){var a,o;!e.autofocus||!r||(o=(a=p[0].target)==null?void 0:a.focus)==null||o.call(a)}const x=g(),P=g(),F=Se(""),S=g(),E=M(()=>e.persistentPlaceholder||k.value||e.active);function A(){var r;S.value!==document.activeElement&&((r=S.value)==null||r.focus()),k.value||U()}function z(r){A(),y("click:control",r)}function I(r){y("mousedown:control",r)}function R(r){r.stopPropagation(),A(),J(()=>{c.value="",Ne(e["onClick:clear"],r)})}function q(r){var a;const p=r.target;if(c.value=p.value,(a=e.modelModifiers)!=null&&a.trim){const o=[p.selectionStart,p.selectionEnd];J(()=>{p.selectionStart=o[0],p.selectionEnd=o[1]})}}const V=g(),h=g(+e.rows),G=M(()=>["plain","underlined"].includes(e.variant));Ae(()=>{e.autoGrow||(h.value=+e.rows)});function w(){e.autoGrow&&J(()=>{if(!V.value||!P.value)return;const r=getComputedStyle(V.value),p=getComputedStyle(P.value.$el),a=parseFloat(r.getPropertyValue("--v-field-padding-top"))+parseFloat(r.getPropertyValue("--v-input-padding-top"))+parseFloat(r.getPropertyValue("--v-field-padding-bottom")),o=V.value.scrollHeight,m=parseFloat(r.lineHeight),l=Math.max(parseFloat(e.rows)*m+a,parseFloat(p.getPropertyValue("--v-input-control-height"))),s=parseFloat(e.maxRows)*m+a||1/0,$=Ee(o??0,l,s);h.value=Math.floor(($-a)/m),F.value=qe($)})}Ie(w),H(c,w),H(()=>e.rows,w),H(()=>e.maxRows,w),H(()=>e.density,w);let f;return H(V,r=>{r?(f=new ResizeObserver(w),f.observe(V.value)):f==null||f.disconnect()}),Re(()=>{f==null||f.disconnect()}),Ve(()=>{const r=!!(i.counter||e.counter||e.counterValue),p=!!(r||i.details),[a,o]=ye(b),{modelValue:m,...l}=Q.filterProps(e),s=$e(e);return t(Q,L({ref:x,modelValue:c.value,"onUpdate:modelValue":$=>c.value=$,class:["v-textarea v-text-field",{"v-textarea--prefixed":e.prefix,"v-textarea--suffixed":e.suffix,"v-text-field--prefixed":e.prefix,"v-text-field--suffixed":e.suffix,"v-textarea--auto-grow":e.autoGrow,"v-textarea--no-resize":e.noResize||e.autoGrow,"v-input--plain-underlined":G.value},e.class],style:e.style},a,l,{centerAffix:h.value===1&&!G.value,focused:k.value}),{...i,default:$=>{let{id:j,isDisabled:Z,isDirty:W,isReadonly:xe,isValid:be}=$;return t(De,L({ref:P,style:{"--v-textarea-control-height":F.value},onClick:z,onMousedown:I,"onClick:clear":R,"onClick:prependInner":e["onClick:prependInner"],"onClick:appendInner":e["onClick:appendInner"]},s,{id:j.value,active:E.value||W.value,centerAffix:h.value===1&&!G.value,dirty:W.value||e.dirty,disabled:Z.value,focused:k.value,error:be.value===!1}),{...i,default:ke=>{let{props:{class:ee,...ae}}=ke;return t(K,null,[e.prefix&&t("span",{class:"v-text-field__prefix"},[e.prefix]),te(t("textarea",L({ref:S,class:ee,value:c.value,onInput:q,autofocus:e.autofocus,readonly:xe.value,disabled:Z.value,placeholder:e.placeholder,rows:e.rows,name:e.name,onFocus:A,onBlur:v},ae,o),null),[[Me("intersect"),{handler:N},null,{once:!0}]]),e.autoGrow&&te(t("textarea",{class:[ee,"v-textarea__sizer"],id:`${ae.id}-sizer`,"onUpdate:modelValue":he=>c.value=he,ref:V,readonly:!0,"aria-hidden":"true"},null),[[Ue,c.value]]),e.suffix&&t("span",{class:"v-text-field__suffix"},[e.suffix])])}})},details:p?$=>{var j;return t(K,null,[(j=i.details)==null?void 0:j.call(i,$),r&&t(K,null,[t("span",null,null),t(Be,{active:e.persistentCounter||k.value,value:B.value,max:T.value,disabled:e.disabled},i.counter)])])}:void 0})}),Te({},x,P,S)}}),pa={class:"text-center"},ga={__name:"products",setup(e){const{t:n}=ze(),{apiAuth:b}=Ze(),y=Ge(),i=He([]),c=g(""),k=M(()=>[{title:"ID",key:"_id",sortable:!0},{title:"IMAGE",key:"image",sortable:!1},{title:"NAME",key:"name",sortable:!0},{title:n("product.description"),key:"description",sortable:!0},{title:n("product.price"),key:"price",sortable:!0},{title:n("product.category"),key:"category",sortable:!0},{title:n("product.sell"),key:"sell",sortable:!0},{title:n("product.createdAt"),key:"createdAt",sortable:!0},{title:n("product.updatedAt"),key:"updatedAt",sortable:!0},{title:n("adminProduct.edit"),key:"edit",sortable:!1}]),U=async()=>{var a,o;try{const{data:m}=await b.get("/product/all");i.push(...m.result)}catch(m){console.log(m),y({text:n("api."+(((o=(a=m==null?void 0:m.response)==null?void 0:a.data)==null?void 0:o.message)||"unknownError")),snackbarProps:{color:"red"}})}};U();const v=g({open:!1,id:""}),B=a=>{a&&(v.value.id=a._id,I.value.value=a.name,R.value.value=a.price,q.value.value=a.description,V.value.value=a.category,h.value.value=a.sell),v.value.open=!0},T=()=>{z(),v.value.id="",v.value.open=!1,w.value.deleteFileRecord()},N=g(""),x=g({open:!1,id:""}),P=a=>{N.value=a,x.value.open=!0},F=()=>{x.value.id="",x.value.open=!1},S=We({name:Y().required(n("api.productNameRequired")),price:ea().required(n("api.productPriceRequired")).min(0,n("api.productPriceTooSmall")),description:Y().required(n("api.productDescriptionRequired")),category:Y().required(n("api.productCategoryRequired")).oneOf(["food","drink","music","phone"],n("api.productCategoryInvalid")),sell:aa().required(n("api.productSellRequired"))}),{handleSubmit:E,isSubmitting:A,resetForm:z}=ta({validationSchema:S,initialValues:{name:"",price:0,description:"",category:"",sell:!1}}),I=_("name"),R=_("price"),q=_("description"),V=_("category"),h=_("sell"),G=M(()=>[{text:n("productCategory.food"),value:"food"},{text:n("productCategory.drink"),value:"drink"},{text:n("productCategory.music"),value:"music"},{text:n("productCategory.phone"),value:"phone"}]),w=g(null),f=g([]),r=g([]),p=E(async a=>{var o,m,l;if(!((o=f.value[0])!=null&&o.error)){if(v.value.id.length===0&&f.value.length===0){y({text:n("api.productImageRequired"),snackbarProps:{color:"red"}});return}try{const s=new FormData;s.append("name",a.name),s.append("price",a.price),s.append("description",a.description),s.append("category",a.category),s.append("sell",a.sell),f.value.length>0&&s.append("image",f.value[0].file),v.value.id.length>0?await b.patch("/product/"+v.value.id,s):await b.post("/product",s),i.splice(0,i.length),U(),y({text:n(v.value.id.length>0?"adminProduct.editSuccess":"adminProduct.newSuccess"),snackbarProps:{color:"green"}}),T()}catch(s){console.log(s),y({text:n("api."+(((l=(m=s==null?void 0:s.response)==null?void 0:m.data)==null?void 0:l.message)||"unknownError")),snackbarProps:{color:"red"}})}}});return(a,o)=>{const m=Oe("VueFileAgent");return le(),_e(K,null,[t(da,null,{default:u(()=>[t(oa,null,{default:u(()=>[t(ie,{cols:"12"},{default:u(()=>[Le("h1",pa,C(a.$t("nav.adminProducts")),1)]),_:1}),t(na),t(ie,{cols:"12"},{default:u(()=>[t(ua,{items:i,headers:k.value,search:c.value},{top:u(()=>[t(ia,null,{default:u(()=>[t(O,{onClick:o[0]||(o[0]=l=>B(null))},{default:u(()=>[D(C(a.$t("adminProduct.new")),1)]),_:1}),t(oe),t(X,{modelValue:c.value,"onUpdate:modelValue":o[1]||(o[1]=l=>c.value=l),"prepend-inner-icon":"mdi-magnify",variant:"underlined"},null,8,["modelValue"])]),_:1})]),"item.image":u(({value:l})=>[t(ne,{src:l,height:"50",class:"cursor-pointer",onClick:s=>P(l)},null,8,["src","onClick"])]),"item.sell":u(({value:l})=>[l?(le(),je(Ke,{key:0,icon:"mdi-check"})):Qe("",!0)]),"item.createdAt":u(({value:l})=>[D(C(new Date(l).toLocaleString()),1)]),"item.updatedAt":u(({value:l})=>[D(C(new Date(l).toLocaleString()),1)]),"item.category":u(({value:l})=>[D(C(a.$t("productCategory."+l)),1)]),"item.edit":u(({item:l})=>[t(O,{icon:"mdi-pencil",variant:"text",onClick:s=>B(l)},null,8,["onClick"])]),_:2},1032,["items","headers","search"])]),_:1})]),_:1})]),_:1}),t(se,{modelValue:v.value.open,"onUpdate:modelValue":o[9]||(o[9]=l=>v.value.open=l),persistent:"",transition:"dialog-bottom-transition"},{default:u(()=>[t(la,{disabled:d(A),onSubmit:Je(d(p),["prevent"])},{default:u(()=>[t(re,null,{default:u(()=>[t(Xe,null,{default:u(()=>[D(C(a.$t(v.value.id?"adminProduct.edit":"adminProduct.new")),1)]),_:1}),t(Ye,null,{default:u(()=>[t(X,{modelValue:d(I).value.value,"onUpdate:modelValue":o[2]||(o[2]=l=>d(I).value.value=l),label:a.$t("product.name"),"error-messages":d(I).errorMessage.value},null,8,["modelValue","label","error-messages"]),t(X,{modelValue:d(R).value.value,"onUpdate:modelValue":o[3]||(o[3]=l=>d(R).value.value=l),label:a.$t("product.price"),"error-messages":d(R).errorMessage.value,type:"number",min:"0"},null,8,["modelValue","label","error-messages"]),t(sa,{modelValue:d(V).value.value,"onUpdate:modelValue":o[4]||(o[4]=l=>d(V).value.value=l),"error-messages":d(V).errorMessage.value,items:G.value,label:a.$t("product.category"),"item-title":"text","item-value":"value"},null,8,["modelValue","error-messages","items","label"]),t(ma,{modelValue:d(h).value.value,"onUpdate:modelValue":o[5]||(o[5]=l=>d(h).value.value=l),label:a.$t("product.onSell"),"error-messages":d(h).errorMessage.value},null,8,["modelValue","label","error-messages"]),t(fa,{modelValue:d(q).value.value,"onUpdate:modelValue":o[6]||(o[6]=l=>d(q).value.value=l),label:a.$t("product.description"),"error-messages":d(q).errorMessage.value},null,8,["modelValue","label","error-messages"]),t(m,{ref_key:"fileAgent",ref:w,modelValue:f.value,"onUpdate:modelValue":o[7]||(o[7]=l=>f.value=l),"raw-model-value":r.value,"onUpdate:rawModelValue":o[8]||(o[8]=l=>r.value=l),accept:"image/jpeg,image/png",deletable:"","max-size":"1MB","help-text":a.$t("fileAgent.helpText"),"error-text":{type:a.$t("fileAgent.errorType"),size:a.$t("fileAgent.errorSize")}},null,8,["modelValue","raw-model-value","help-text","error-text"])]),_:1}),t(ue,null,{default:u(()=>[t(O,{onClick:T},{default:u(()=>[D(C(a.$t("adminProduct.cancel")),1)]),_:1}),t(O,{type:"submit",loading:d(A)},{default:u(()=>[D(C(a.$t("adminProduct.submit")),1)]),_:1},8,["loading"])]),_:1})]),_:1})]),_:1},8,["disabled","onSubmit"])]),_:1},8,["modelValue"]),t(se,{modelValue:x.value.open,"onUpdate:modelValue":o[10]||(o[10]=l=>x.value.open=l),"max-width":"600"},{default:u(()=>[t(re,null,{default:u(()=>[t(ne,{src:N.value,"max-height":"500",contain:""},null,8,["src"]),t(ue,null,{default:u(()=>[t(oe),t(O,{text:"",onClick:F},{default:u(()=>[D(C(a.$t("adminProduct.cancel")),1)]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])],64)}}};typeof de=="function"&&de(ga);export{ga as default};
