import{a1 as y,al as A,am as T,a2 as $,S as P,U as R,a4 as l,L as o,_ as m,Y as p,a5 as s,aR as q,az as g,an as B,a6 as F,ar as U}from"./index-O_OIJZ_k.js";import{c as C,a as V,u as L,e as f,V as M}from"./index.esm-BYzkOkrp.js";import{v as N}from"./index-BePcaPFC.js";import{V as b,a as D,b as v}from"./route-block-XNcMZbMm.js";import{V as I}from"./VDivider-CsSZj-Rn.js";import{V as z}from"./VContainer-BCZ9p7b9.js";const E={class:"text-center"},Y={class:"text-center"},j={__name:"login",setup(G){const{t:e}=y(),{api:h}=U(),c=A(),w=T(),S=$(),_=C({account:V().required(e("api.userAccountRequired")).min(4,e("api.userAccountTooShort")).max(20,e("api.userAccountTooLong")).test("isAlphanumeric",e("api.userAccountInvalid"),a=>N.isAlphanumeric(a)),password:V().required(e("api.userPasswordRequired")).min(4,e("api.userPasswordTooShort")).max(20,e("api.userPasswordTooLong"))}),{handleSubmit:x,isSubmitting:d}=L({validationSchema:_}),u=f("account"),i=f("password"),k=x(async a=>{var r,t;try{const{data:n}=await h.post("/user/login",{account:a.account,password:a.password});S.login(n.result),c({text:e("login.success"),snackbarProps:{color:"green"}}),w.push("/")}catch(n){console.log(n),c({text:e("api."+(((t=(r=n==null?void 0:n.response)==null?void 0:r.data)==null?void 0:t.message)||"unknownError")),snackbarProps:{color:"red"}})}});return(a,r)=>(P(),R(z,null,{default:l(()=>[o(D,null,{default:l(()=>[o(b,{cols:"12"},{default:l(()=>[m("h1",E,p(a.$t("nav.login")),1)]),_:1}),o(I),o(b,{cols:"12"},{default:l(()=>[o(M,{disabled:s(d),onSubmit:q(s(k),["prevent"])},{default:l(()=>[o(g,{modelValue:s(u).value.value,"onUpdate:modelValue":r[0]||(r[0]=t=>s(u).value.value=t),"error-messages":s(u).errorMessage.value,label:a.$t("user.account"),minlength:"4",maxlength:"20",counter:""},null,8,["modelValue","error-messages","label"]),o(g,{modelValue:s(i).value.value,"onUpdate:modelValue":r[1]||(r[1]=t=>s(i).value.value=t),type:"password","error-messages":s(i).errorMessage.value,label:a.$t("user.password"),minlength:"4",maxlength:"20",counter:""},null,8,["modelValue","error-messages","label"]),m("div",Y,[o(B,{loading:s(d),type:"submit",color:"primary"},{default:l(()=>[F(p(a.$t("login.submit")),1)]),_:1},8,["loading"])])]),_:1},8,["disabled","onSubmit"])]),_:1})]),_:1})]),_:1}))}};typeof v=="function"&&v(j);export{j as default};
