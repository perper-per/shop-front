import{a2 as $,am as A,al as E,a1 as I,G as q,c as v,S as n,U as g,a4 as s,L as e,_ as h,Y as u,X as y,a7 as z,O as b,an as d,a6 as C,aV as D,V as P,Z as R,ar as U}from"./index-O_OIJZ_k.js";import{V as p,a as F,b as w}from"./route-block-XNcMZbMm.js";import{V as x}from"./VDivider-CsSZj-Rn.js";import{V as G,a as O}from"./VList-B5bKv3Qo.js";import{V as T}from"./VContainer-BCZ9p7b9.js";const X={class:"text-center"},Y={__name:"cart",setup(Z){const{apiAuth:i}=U(),m=$(),B=A(),_=E(),{t:f}=I(),c=q([]),k=async()=>{try{const{data:t}=await i.get("/user/cart");c.value=t.result}catch(t){console.log(t)}};k();const L=v(()=>c.value.reduce((t,r)=>t+r.product.price*r.quantity,0)),N=v(()=>c.value.length>0&&c.value.every(t=>t.product.sell)),V=async(t,r)=>{var a,l;try{const{data:o}=await i.patch("/user/cart",{product:t,quantity:r});m.cart=o.result,k()}catch(o){console.log(o),_({text:f("api."+(((l=(a=o==null?void 0:o.response)==null?void 0:a.data)==null?void 0:l.message)||"unknownError")),snackbarProps:{color:"red"}})}},S=async()=>{var t,r;try{await i.post("/order"),m.cart=0,B.push("/orders")}catch(a){console.log(a),_({text:f("api."+(((r=(t=a==null?void 0:a.response)==null?void 0:t.data)==null?void 0:r.message)||"unknownError")),snackbarProps:{color:"red"}})}};return(t,r)=>(n(),g(T,null,{default:s(()=>[e(F,null,{default:s(()=>[e(p,{cols:"12"},{default:s(()=>[h("h1",X,u(t.$t("nav.cart")),1)]),_:1}),e(x),e(p,{cols:"12"},{default:s(()=>[e(G,{lines:"two"},{default:s(()=>[(n(!0),y(b,null,z(c.value,(a,l)=>(n(),y(b,{key:a._id},[e(O,{title:a.product.name,subtitle:a.product.price,"active-class":"bg-error",active:!a.product.sell},{prepend:s(()=>[e(D,{rounded:"0"},{default:s(()=>[e(P,{src:a.product.image},null,8,["src"])]),_:2},1024)]),append:s(()=>[e(d,{color:"rgba(50, 50, 50, 0.5)",icon:"mdi-plus",size:"small",class:"mr-4",onClick:o=>V(a.product._id,1)},null,8,["onClick"]),C(" "+u(a.quantity)+" ",1),e(d,{color:"rgba(50, 50, 50, 0.5)",icon:"mdi-minus",size:"small",class:"ml-4",onClick:o=>V(a.product._id,-1)},null,8,["onClick"])]),_:2},1032,["title","subtitle","active"]),l<c.value.length-1?(n(),g(x,{key:0})):R("",!0)],64))),128))]),_:1})]),_:1}),e(p,{cols:"12",class:"text-center"},{default:s(()=>[h("p",null,u(L.value),1),e(d,{color:"primary",disabled:!N.value,onClick:S},{default:s(()=>[C(u(t.$t("cart.checkout")),1)]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1}))}};typeof w=="function"&&w(Y);export{Y as default};
